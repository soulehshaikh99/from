document.addEventListener("DOMContentLoaded",(function(){const e=$.qs("#te"),t=$.qs("#in"),o=$.qs("#ix"),c=$.qs("#iw"),l=$.qs("#ts"),r=$.qs("#ik"),n=$.qs("#t"),a=$.qs("#ti"),u=$.qs("#x"),s=$.qs("#io"),i=$.qs("#th"),v=$.qs(".stockavgcal-output__investment-breakdown"),g=$.qs(".stockavgcal-output__portfolio-summary"),y=$.qs(".stockavgcal-output__breakeven-metrics"),S=$.qs(".stockavgcal-output__price-insights"),_=$.qs("#rc"),d=$.qs("#_"),q=$.qsa(".hl"),m=$.qs(".stockavgcal__advanced-paramters");function p(){for(const e of q)if(e.checked)return e.value;return null}function k(e){"basic"===(e=e||p())?$.conceal(l.closest(".pl"),r.closest(".pl"),m):$.reveal(m),$.conceal(i)}function h(e=1){if(e>=1&&e<=10)return["First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"][e-1];const t=(()=>{const t=e%10,o=e%100;return 1===t&&11!==o?"st_conflict":2===t&&12!==o?"nd_conflict":3===t&&13!==o?"rd_conflict":"th"})();return`${e}${t}`}function x(){const e=$.qs(".hw");let t=h(e.children.length+1);const o=$.qs(".hx").cloneNode(!0),c=o.querySelector(".h_"),l=document.createElement("img");l.classList.add("stockavgcal__purchase-remove"),l.setAttribute("src","/assets/images/a6d3e123.svg"),c.textContent=`${t} Purchase`,c.after(l),l.addEventListener("click",(()=>{e.removeChild(o),function(){const e=$.qsa(".hx");for(let t=0;t<e.length;t++){const o=e[t],c=o.querySelector(".h_");let l=h(t+1);c.textContent=`${l} Purchase`,l=l.toLowerCase(),o.querySelector(".pe").setAttribute("for",`${l}-purchase`),o.querySelector(".ps").id=`${l}-purchase`,o.querySelector(".pt").setAttribute("for",`${l}-quantity`),o.querySelector(".stockavgcal__purchase-quantity").id=`${l}-quantity`}}(),b()})),t=t.toLowerCase(),o.querySelector(".pe").setAttribute("for",`${t}-purchase`),o.querySelector(".ps").id=`${t}-purchase`,o.querySelector(".pt").setAttribute("for",`${t}-quantity`),o.querySelector(".stockavgcal__purchase-quantity").id=`${t}-quantity`,o.querySelector(".ps").value=0,o.querySelector(".stockavgcal__purchase-quantity").value=0,e.appendChild(o)}function f(e){const t=$.qsa(".pr");for(let o=0;o<t.length;o++){t[o].textContent=e}}function b(){const e=p(),n=$.qsa(".hx");let _=0,d=0,q=1/0,m=-1/0;const k=[];for(const e of n){const t=e.querySelector(".ps"),o=e.querySelector(".stockavgcal__purchase-quantity"),c=parseFloat(t.value||0),l=parseFloat(o.value||0);_+=l,d+=c*l,q>c&&(q=c),m<c&&(m=c),k.push({buyPrice:c,quantity:l,invested:(c*l).toFixed(2)})}if(!d||!_)return;const x=_>0?d/_:0,f=Number(x.toFixed(2)).toLocaleString(),b=Number(_.toFixed(2)).toLocaleString(),L=Number(d.toFixed(2)).toLocaleString();t.textContent=f,o.textContent=b,c.textContent=L;const C=parseFloat(a.value||0);if(C>0&&_>0){const e=C*_-d,t=e/d*100;l.textContent=`${e>=0?"+":""}${Number(e.toFixed(2)).toLocaleString()}`,r.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}%`,l.classList.toggle("in-profit",e>0),l.classList.toggle("in-loss",e<0),r.classList.toggle("in-profit",t>0),r.classList.toggle("in-loss",t<0),$.reveal(l.closest(".pl"),r.closest(".pl"))}else $.conceal(l.closest(".pl"),r.closest(".pl"));const N=v.querySelectorAll(".pv");for(let e=1;e<N.length;e++)N[e].remove();let F=0,A=1/0,w=-1/0,E=0,P=0;const z=N[0];for(let t=0;t<k.length;t++){const o=k[t],c=z.cloneNode(!0);let l=0;t===k.length-1?l=Number((100-F).toFixed(2)):d>0&&(l=(o.invested/d*100).toFixed(2),F+=Number(l)),A>l&&(A=l,E=o.buyPrice),w<l&&(w=l,P=o.buyPrice);const r=c.querySelector(".stockavgcal__current-column"),n=c.querySelector(".stockavgcal__current-pl-column"),a=c.querySelector(".stockavgcal__net-change-column"),u=c.querySelector(".stockavgcal__allocation-column");if(c.querySelector(".pm").textContent=`${h(t+1)} Purchase`,c.querySelector(".stockavgcal__buy-price-value").textContent=o.buyPrice.toLocaleString(),c.querySelector(".stockavgcal__quantity-value").textContent=o.quantity.toLocaleString(),c.querySelector(".stockavgcal__invested-value").textContent=Number(o.invested).toLocaleString(),c.querySelector(".stockavgcal__allocation-value").textContent=`${Number(l)}%`,"basic"===e?$.conceal(r,n,a,u):$.reveal(r,n,a,u),"advanced"===e&&C>0){const e=c.querySelector(".stockavgcal__current-pl-value"),t=c.querySelector(".stockavgcal__net-change-value"),l=(C*o.quantity).toFixed(2),r=(l-o.invested).toFixed(2),n=(r/o.invested*100).toFixed(2);c.querySelector(".stockavgcal__current-value").textContent=Number(l).toLocaleString(),e.textContent=`${r>=0?"+":""}${Number(r).toLocaleString()}`,t.textContent=`${n>=0?"+":""}${Number(n).toLocaleString()}%`,e.classList.toggle("in-profit",r>0),e.classList.toggle("in-loss",r<0),t.classList.toggle("in-profit",r>0),t.classList.toggle("in-loss",r<0)}else $.conceal(r,n,a);v.appendChild(c)}z.remove();const I=g.querySelector(".stockavgcal__cmp-column"),Z=g.querySelector(".stockavgcal__total-column"),D=g.querySelector(".stockavgcal__total-pl-column"),T=g.querySelector(".stockavgcal__total-return-column");if("basic"===e?$.conceal(I,Z,D,T):$.reveal(I,Z,D,T),g.querySelector(".stockavgcal__average-buy-price-value").textContent=f,g.querySelector(".stockavgcal__total-quantity-value").textContent=b,g.querySelector(".stockavgcal__total-invested-value").textContent=L,"advanced"===e&&C>0){const e=C*_,t=e-d,o=t/d*100,c=g.querySelector(".stockavgcal__total-pl-value"),l=g.querySelector(".stockavgcal__total-return-value");g.querySelector(".stockavgcal__cmp-value").textContent=C.toLocaleString(),g.querySelector(".stockavgcal__total-value").textContent=Number(e).toLocaleString(),c.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}`,l.textContent=`${o>=0?"+":""}${Number(o.toFixed(2)).toLocaleString()}%`,c.classList.toggle("in-profit",t>0),c.classList.toggle("in-loss",t<0),l.classList.toggle("in-profit",t>0),l.classList.toggle("in-loss",t<0)}else $.conceal(I,Z,D,T);P===E?$.conceal(S.querySelector(".stockavgcal__highest-allocation-column"),S.querySelector(".stockavgcal__lowest-allocation-column")):($.reveal(S.querySelector(".stockavgcal__highest-allocation-column"),S.querySelector(".stockavgcal__lowest-allocation-column")),S.querySelector(".stockavgcal__highest-allocation-value").textContent=Number(P).toLocaleString(),S.querySelector(".stockavgcal__lowest-allocation-value").textContent=Number(E).toLocaleString()),q===m?$.conceal(S.querySelector(".stockavgcal__cheapest-buy-column"),S.querySelector(".stockavgcal__expensive-buy-column")):($.reveal(S.querySelector(".stockavgcal__cheapest-buy-column"),S.querySelector(".stockavgcal__expensive-buy-column")),S.querySelector(".stockavgcal__cheapest-buy-value").textContent=Number(q).toLocaleString(),S.querySelector(".stockavgcal__expensive-buy-value").textContent=Number(m).toLocaleString());const M=parseFloat(u.value||0),O=parseFloat(s.value||0);if("advanced"===e&&(M>0||O>0)){const e=M+O,t=(d+e)/_,o=t-x;if(y.querySelector(".stockavgcal__total-charges-value").textContent=e.toLocaleString(),y.querySelector(".stockavgcal__breakeven-price-value").textContent=Number(t.toFixed(2)).toLocaleString(),y.querySelector(".stockavgcal__points-to-breakeven-value").textContent=Number(o.toFixed(2)).toLocaleString(),C>0){const t=C*_-d-e,o=t/d*100;y.querySelector(".stockavgcal__effective-pl-value").textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}`,y.querySelector(".stockavgcal__net-return-value").textContent=`${o>=0?"+":""}${Number(o.toFixed(2)).toLocaleString()}%`,$.reveal(y.querySelector(".stockavgcal__effective-pl-column"),y.querySelector(".stockavgcal__net-return-column"))}else $.conceal(y.querySelector(".stockavgcal__effective-pl-column"),y.querySelector(".stockavgcal__net-return-column"));$.reveal(y)}else $.conceal(y);$.reveal(i,v,g),P!==E||q!==m?$.reveal(S):$.conceal(S)}$.qs("#q").addEventListener("submit",(function(e){e.preventDefault();const t=$.qs("#tp").value;/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?window.location.href="/contact-us.html?email="+encodeURIComponent(t):alert("Please enter a valid email address.")})),k(),function(){e.addEventListener("change",(e=>{const t=e.target.value;t&&sessionStorage.setItem("currency-preference",t),f(t)})),n.addEventListener("click",(()=>{x()})),d.addEventListener("click",(()=>{b()})),_.addEventListener("click",(()=>{!function(){const e=$.qsa(".hx");for(const t of e){const e=t.querySelector(".ps"),o=t.querySelector(".stockavgcal__purchase-quantity");e.value=0,o.value=0}t.textContent=0,o.textContent=0,c.textContent=0,a.value=0,$.conceal(l.closest(".pl"),r.closest(".pl"),i,v,g,y,S);const n=v.querySelectorAll(".pv");for(let e=1;e<n.length;e++)n[e].remove()}()}));for(const e of q)e.addEventListener("change",(e=>{k(e.target.value)}));const u=sessionStorage.getItem("currency-preference");u&&(e.value=u,f(u))}()}));