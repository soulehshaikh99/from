document.addEventListener("DOMContentLoaded",(function(){const e=$.qs("#tt"),t=$.qs("#if"),o=$.qs("#st"),c=$.qs("#iz"),r=$.qs("#to"),l=$.qs("#sn"),n=$.qs("#t"),a=$.qs("#ts"),u=$.qs("#tp"),s=$.qs(".stockavgcal-output__investment-breakdown"),i=$.qs(".stockavgcal-output__portfolio-summary"),v=$.qs(".stockavgcal-output__breakeven-metrics"),d=$.qs(".stockavgcal-output__price-insights"),g=$.qs("#ry"),y=$.qs("#_"),S=$.qsa(".hl"),q=$.qs(".stockavgcal__advanced-paramters");function _(){for(const e of S)if(e.checked)return e.value;return null}function m(e){"basic"===(e=e||_())?$.conceal(r.closest(".pf"),l.closest(".pf"),q):$.reveal(q),$.conceal(u)}function p(e=1){if(e>=1&&e<=10)return["First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"][e-1];const t=(()=>{const t=e%10,o=e%100;return 1===t&&11!==o?"st_conflict":2===t&&12!==o?"nd_conflict":3===t&&13!==o?"rd_conflict":"th"})();return`${e}${t}`}function f(){const e=$.qs(".hw");let t=p(e.children.length+1);const o=$.qs(".hx").cloneNode(!0),c=o.querySelector(".h_"),r=document.createElement("img");r.classList.add("stockavgcal__purchase-remove"),r.setAttribute("src","/assets/images/a6d3e123.svg"),c.textContent=`${t} Purchase`,c.after(r),r.addEventListener("click",(()=>{e.removeChild(o),function(){const e=$.qsa(".hx");for(let t=0;t<e.length;t++){const o=e[t],c=o.querySelector(".h_");let r=p(t+1);c.textContent=`${r} Purchase`,r=r.toLowerCase(),o.querySelector(".pe").setAttribute("for",`${r}-purchase`),o.querySelector(".pi").id=`${r}-purchase`,o.querySelector(".stockavgcal__purchase-label--quantity").setAttribute("for",`${r}-quantity`),o.querySelector(".stockavgcal__purchase-quantity").id=`${r}-quantity`}}(),x()})),t=t.toLowerCase(),o.querySelector(".pe").setAttribute("for",`${t}-purchase`),o.querySelector(".pi").id=`${t}-purchase`,o.querySelector(".stockavgcal__purchase-label--quantity").setAttribute("for",`${t}-quantity`),o.querySelector(".stockavgcal__purchase-quantity").id=`${t}-quantity`,o.querySelector(".pi").value=0,o.querySelector(".stockavgcal__purchase-quantity").value=0,e.appendChild(o)}function h(e){const t=$.qsa(".pn");for(let o=0;o<t.length;o++){t[o].textContent=e}}function x(){const e=_(),n=$.qsa(".hx");let v=0,d=0;const g=[];for(const e of n){const t=e.querySelector(".pi"),o=e.querySelector(".stockavgcal__purchase-quantity"),c=parseFloat(t.value||0),r=parseFloat(o.value||0);v+=r,d+=c*r,g.push({buyPrice:c,quantity:r,invested:(c*r).toFixed(2)})}if(!d||!v)return;const y=Number((v>0?d/v:0).toFixed(2)).toLocaleString(),S=Number(v.toFixed(2)).toLocaleString(),q=Number(d.toFixed(2)).toLocaleString();t.textContent=y,o.textContent=S,c.textContent=q;const m=parseFloat(a.value||0);if(m>0&&v>0){const e=m*v-d,t=e/d*100;r.textContent=`${e>=0?"+":""}${Number(e.toFixed(2)).toLocaleString()}`,l.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}%`,r.classList.toggle("in-profit",e>0),r.classList.toggle("in-loss",e<0),l.classList.toggle("in-profit",t>0),l.classList.toggle("in-loss",t<0),$.reveal(r.closest(".pf"),l.closest(".pf"))}else $.conceal(r.closest(".pf"),l.closest(".pf"));const f=s.querySelectorAll(".pd");for(let e=1;e<f.length;e++)f[e].remove();let h=0;const x=f[0];for(let t=0;t<g.length;t++){const o=g[t],c=x.cloneNode(!0);let r=0;t===g.length-1?r=Number((100-h).toFixed(2)):d>0&&(r=(o.invested/d*100).toFixed(2),h+=Number(r));const l=c.querySelector(".stockavgcal__current-column"),n=c.querySelector(".stockavgcal__current-pl-column"),a=c.querySelector(".stockavgcal__net-change-column"),u=c.querySelector(".stockavgcal__allocation-column");if(c.querySelector(".pv").textContent=`${p(t+1)} Purchase`,c.querySelector(".stockavgcal__buy-price-value").textContent=o.buyPrice.toLocaleString(),c.querySelector(".stockavgcal__quantity-value").textContent=o.quantity.toLocaleString(),c.querySelector(".stockavgcal__invested-value").textContent=Number(o.invested).toLocaleString(),c.querySelector(".stockavgcal__allocation-value").textContent=`${Number(r)}%`,"basic"===e?$.conceal(l,n,a,u):$.reveal(l,n,a,u),"advanced"===e&&m>0){const e=c.querySelector(".stockavgcal__current-pl-value"),t=c.querySelector(".stockavgcal__net-change-value"),r=(m*o.quantity).toFixed(2),l=(r-o.invested).toFixed(2),n=(l/o.invested*100).toFixed(2);c.querySelector(".stockavgcal__current-value").textContent=Number(r).toLocaleString(),e.textContent=`${l>=0?"+":""}${Number(l).toLocaleString()}`,t.textContent=`${n>=0?"+":""}${Number(n).toLocaleString()}%`,e.classList.toggle("in-profit",l>0),e.classList.toggle("in-loss",l<0),t.classList.toggle("in-profit",l>0),t.classList.toggle("in-loss",l<0)}else $.conceal(l,n,a);s.appendChild(c)}x.remove();const k=i.querySelector(".stockavgcal__cmp-column"),L=i.querySelector(".stockavgcal__total-column"),C=i.querySelector(".stockavgcal__total-pl-column"),b=i.querySelector(".stockavgcal__total-return-column");if("basic"===e?$.conceal(k,L,C,b):$.reveal(k,L,C,b),i.querySelector(".stockavgcal__average-buy-price-value").textContent=y,i.querySelector(".stockavgcal__total-quantity-value").textContent=S,i.querySelector(".stockavgcal__total-invested-value").textContent=q,"advanced"===e&&m>0){const e=m*v,t=e-d,o=t/d*100,c=i.querySelector(".stockavgcal__total-pl-value"),r=i.querySelector(".stockavgcal__total-return-value");i.querySelector(".stockavgcal__cmp-value").textContent=m.toLocaleString(),i.querySelector(".stockavgcal__total-value").textContent=Number(e).toLocaleString(),c.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}`,r.textContent=`${o>=0?"+":""}${Number(o.toFixed(2)).toLocaleString()}%`,c.classList.toggle("in-profit",t>0),c.classList.toggle("in-loss",t<0),r.classList.toggle("in-profit",t>0),r.classList.toggle("in-loss",t<0)}else $.conceal(k,L,C,b);$.reveal(u,s,i)}$.qs("#z").addEventListener("submit",(function(e){e.preventDefault();const t=$.qs("#tv").value;/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?window.location.href="/contact-us.html?email="+encodeURIComponent(t):alert("Please enter a valid email address.")})),m(),function(){e.addEventListener("change",(e=>{const t=e.target.value;t&&sessionStorage.setItem("currency-preference",t),h(t)})),n.addEventListener("click",(()=>{f()})),y.addEventListener("click",(()=>{x()})),g.addEventListener("click",(()=>{!function(){const e=$.qsa(".hx");for(const t of e){const e=t.querySelector(".pi"),o=t.querySelector(".stockavgcal__purchase-quantity");e.value=0,o.value=0}t.textContent=0,o.textContent=0,c.textContent=0,a.value=0,$.conceal(r.closest(".pf"),l.closest(".pf"),u,s,i,v,d);const n=s.querySelectorAll(".pd");for(let e=1;e<n.length;e++)n[e].remove()}()}));for(const e of S)e.addEventListener("change",(e=>{m(e.target.value)}));const q=sessionStorage.getItem("currency-preference");q&&(e.value=q,h(q))}()}));